<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Notes: Introduction to Nonparametric Bootstrapping â€¢ jeksterslabRboot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Notes: Introduction to Nonparametric Bootstrapping">
<meta property="og:description" content="jeksterslabRboot">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">jeksterslabRboot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/jeksterslabRboot.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/notes/notes_intro_nb.html">Notes: Introduction to Nonparametric Bootstrapping</a>
    </li>
    <li>
      <a href="../../articles/notes/notes_intro_pb.html">Notes: Introduction to Parametric Bootstrapping</a>
    </li>
    <li>
      <a href="../../articles/notes/notes_nb_med.html">Notes: Nonparametric Bootstrapping - Mediation</a>
    </li>
    <li>
      <a href="../../articles/tests/test_alpha2prob.html">Test: alpha2prob</a>
    </li>
    <li>
      <a href="../../articles/tests/test_eval.html">Test: eval</a>
    </li>
    <li>
      <a href="../../articles/tests/test_jack.html">Test: jack</a>
    </li>
    <li>
      <a href="../../articles/tests/test_mc.html">Test: mc</a>
    </li>
    <li>
      <a href="../../articles/tests/test_nb_bivariate.html">Test: Nonparametric Bootstrap - Bivariate</a>
    </li>
    <li>
      <a href="../../articles/tests/test_nb_univ.html">Test: Nonparametric Bootstrap - Univariate</a>
    </li>
    <li>
      <a href="../../articles/tests/test_pb_bivariate.html">Test: Parametric Bootstrap - Bivariate</a>
    </li>
    <li>
      <a href="../../articles/tests/test_pb_univ.html">Test: Parametric Bootstrap - Univariate</a>
    </li>
    <li>
      <a href="../../articles/tests/test_wald.html">Test: wald</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jeksterslabds/jeksterslabRboot/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="notes_intro_nb_files/header-attrs-2.3/header-attrs.js"></script><script src="notes_intro_nb_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Notes: Introduction to Nonparametric Bootstrapping</h1>
                        <h4 class="author">Ivan Jacob Agaloos Pesigan</h4>
            
            <h4 class="date">2020-07-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jeksterslabds/jeksterslabRboot/blob/master/vignettes/notes/notes_intro_nb.Rmd"><code>vignettes/notes/notes_intro_nb.Rmd</code></a></small>
      <div class="hidden name"><code>notes_intro_nb.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">jeksterslabRboot</span>)</pre></body></html></div>
<div id="random-variable" class="section level2">
<h2 class="hasAnchor">
<a href="#random-variable" class="anchor"></a>Random Variable</h2>
<p>Let <span class="math inline">\(X\)</span> be a random variable from a normal distribution with <span class="math inline">\(\mu = 100\)</span> and <span class="math inline">\(\sigma^2 = 225\)</span>.</p>
<p><span class="math display">\[\begin{equation}
  X
  \sim
  \mathcal{N}
  \left(
    \mu = 100,
    \sigma^2 = 225
  \right)
\end{equation}\]</span></p>
<p>This data generating function is referred to as <span class="math inline">\(F\)</span>.</p>
<table class="table">
<caption>Population Parameters</caption>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
<th align="left">Notation</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>mu</code></td>
<td align="left">Population mean.</td>
<td align="left"><span class="math inline">\(\mu\)</span></td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left"><code>sigma2</code></td>
<td align="left">Population variance.</td>
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">225</td>
</tr>
<tr class="odd">
<td align="left"><code>sigma</code></td>
<td align="left">Population standard deviation.</td>
<td align="left"><span class="math inline">\(\sigma\)</span></td>
<td align="right">15</td>
</tr>
</tbody>
</table>
<p>For a sample size of <span class="math inline">\(n = 1000\)</span>, if the parameter of interest <span class="math inline">\(\theta\)</span> is the mean <span class="math inline">\(\mu\)</span>, using the know parameters, the variance of the sampling distribution of the mean is</p>
<p><span class="math display">\[\begin{equation}
  \mathrm{Var}
  \left(
    \hat{\mu}
  \right)
  =
  \frac{
    \sigma^2
  }
  {
    n
  }
  =
  0.225
\end{equation}\]</span></p>
<p>and the standard error of the mean is</p>
<p><span class="math display">\[\begin{equation}
  \mathrm{se}
  \left(
    \hat{\mu}
  \right)
  =
  \frac{
    \sigma
  }
  {
    \sqrt{n}
  }
  =
  0.4743416
\end{equation}\]</span></p>
<table class="table">
<caption>Sampling Distribution of <span class="math inline">\(\hat{\theta}\)</span> with Known Parameters</caption>
<colgroup>
<col width="10%">
<col width="34%">
<col width="46%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
<th align="left">Notation</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>n</code></td>
<td align="left">Sample size.</td>
<td align="left"><span class="math inline">\(n\)</span></td>
<td align="right">1000.0000000</td>
</tr>
<tr class="even">
<td align="left"><code>theta</code></td>
<td align="left">Population mean.</td>
<td align="left"><span class="math inline">\(\theta = \mu\)</span></td>
<td align="right">100.0000000</td>
</tr>
<tr class="odd">
<td align="left"><code>var_thetahat</code></td>
<td align="left">Variance of the sampling distribution of the mean.</td>
<td align="left"><span class="math inline">\(\mathrm{Var} \left( \hat{\theta} \right) = \frac{ \sigma^2 }{n}\)</span></td>
<td align="right">0.2250000</td>
</tr>
<tr class="even">
<td align="left"><code>se_thetahat</code></td>
<td align="left">Standard error of the mean.</td>
<td align="left"><span class="math inline">\(\mathrm{se} \left( \hat{\theta} \right) = \frac{ \sigma }{\sqrt{n}}\)</span></td>
<td align="right">0.4743416</td>
</tr>
</tbody>
</table>
</div>
<div id="sample-data" class="section level2">
<h2 class="hasAnchor">
<a href="#sample-data" class="anchor"></a>Sample Data</h2>
<p>Let <span class="math inline">\(\mathbf{x}\)</span> be a vector of length <span class="math inline">\(n = 1000\)</span> of realizations of the random variable <span class="math inline">\(X\)</span>. Each observation <span class="math inline">\(i\)</span> is independently sampled from the normal distribution with <span class="math inline">\(\mu = 100\)</span> and <span class="math inline">\(\sigma^2 = 225\)</span>.</p>
<p><span class="math display">\[\begin{equation}
  \mathbf{x}
  =
  \begin{bmatrix}
    x_1 = X \left( \omega_1 \right) \\
    x_2 = X \left( \omega_2 \right) \\
    x_3 = X \left( \omega_3 \right) \\
    x_i = X \left( \omega_i \right) \\
    \vdots \\
    x_n = X \left( \omega_n \right)
  \end{bmatrix}, \\
  i
  =
  \left\{
    1, 2, 3, \dots, n
  \right\}
\end{equation}\]</span></p>
<p>This is accommplished in <code>R</code> using the <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> function with the following arguments <code>n =</code> 1000, <code>mean =</code> 100, and <code>sd =</code> 15. <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> returns a vector of length <code>n</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(
  <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>,
  <span class="kw">mean</span> <span class="kw">=</span> <span class="no">mu</span>,
  <span class="kw">sd</span> <span class="kw">=</span> <span class="no">sigma</span>
)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">x</span>)
<span class="co">#&gt;  num [1:1000] 120.6 91.5 105.4 109.5 106.1 ...</span></pre></body></html></div>
<p>We can calculate sample statistics using the sample data <span class="math inline">\(\mathbf{x}\)</span>. Note that a hat (^) indicates that the quantity is an estimate of the parameter using sample data.</p>
<table class="table">
<caption>Sample Statistics (Parameter Estimates)</caption>
<colgroup>
<col width="9%">
<col width="35%">
<col width="47%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
<th align="left">Notation</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>n</code></td>
<td align="left">Sample size.</td>
<td align="left"><span class="math inline">\(n\)</span></td>
<td align="right">1000.0000000</td>
</tr>
<tr class="even">
<td align="left"><code>thetahat</code></td>
<td align="left">Sample mean.</td>
<td align="left"><span class="math inline">\(\hat{\theta} = \hat{\mu} = \frac{1}{n} \sum_{i = 1}^{n} x_i\)</span></td>
<td align="right">99.6126336</td>
</tr>
<tr class="odd">
<td align="left"><code>sigma2hat</code></td>
<td align="left">Sample variance.</td>
<td align="left"><span class="math inline">\(\hat{\sigma}^2 = \frac{1}{n - 1} \sum_{i = 1}^{n} \left( x_i - \hat{\mu} \right)^2\)</span></td>
<td align="right">226.1359868</td>
</tr>
<tr class="even">
<td align="left"><code>sigmahat</code></td>
<td align="left">Sample standard deviation.</td>
<td align="left"><span class="math inline">\(\hat{\sigma} = \sqrt{\frac{1}{n - 1} \sum_{i = 1}^{n} \left( x_i - \hat{\mu} \right)^2}\)</span></td>
<td align="right">15.0378186</td>
</tr>
<tr class="odd">
<td align="left"><code>varhat_thetahat</code></td>
<td align="left">Estimate of the variance of the sampling distribution of the mean.</td>
<td align="left"><span class="math inline">\(\widehat{\mathrm{Var}} \left( \hat{\theta} \right) = \frac{ \hat{\sigma}^2 }{n}\)</span></td>
<td align="right">0.2261360</td>
</tr>
<tr class="even">
<td align="left"><code>sehat_thetahat</code></td>
<td align="left">Estimate of the standard error of the mean.</td>
<td align="left"><span class="math inline">\(\widehat{\mathrm{se}} \left( \hat{\theta} \right) = \frac{ \hat{\sigma} }{\sqrt{n}}\)</span></td>
<td align="right">0.4755376</td>
</tr>
</tbody>
</table>
<p><img src="notes_intro_nb_files/figure-html/unnamed-chunk-8-1.png" width="700"><img src="notes_intro_nb_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
</div>
<div id="nonparametric-bootstrapping" class="section level2">
<h2 class="hasAnchor">
<a href="#nonparametric-bootstrapping" class="anchor"></a>Nonparametric Bootstrapping</h2>
<p><span class="math inline">\(\mathbf{x}\)</span> which is a vector of realizations of the random variable <span class="math inline">\(X\)</span> is used in bootstrapping. This sample data is referred to as the empirical distribution <span class="math inline">\(\hat{F}\)</span>.</p>
<p>In nonparametric bootstrapping, the empirical distribution <span class="math inline">\(\hat{F}\)</span> is resampled <span class="math inline">\(B\)</span> number of times (1000 in the current example) with replacement.</p>
<div id="bootstrap-samples" class="section level3">
<h3 class="hasAnchor">
<a href="#bootstrap-samples" class="anchor"></a>Bootstrap Samples</h3>
<p><span class="math inline">\(\mathbf{x}^{*}\)</span> is a set of <span class="math inline">\(B\)</span> bootstrap samples.</p>
<p><span class="math display">\[\begin{equation}
  \mathbf{x}^{*}
  =
  \begin{bmatrix}
    \mathbf{x}^{*1} = \left\{ x^{*1}_{1}, x^{*1}_{2}, x^{*1}_{3}, x^{*1}_{i}, \dots, x^{*1}_{n} \right\} \\
    \mathbf{x}^{*2} = \left\{ x^{*2}_{1}, x^{*2}_{2}, x^{*2}_{3}, x^{*2}_{i}, \dots, x^{*2}_{n} \right\} \\
    \mathbf{x}^{*3} = \left\{ x^{*3}_{1}, x^{*3}_{2}, x^{*3}_{3}, x^{*3}_{i}, \dots, x^{*3}_{n} \right\} \\
    \mathbf{x}^{*b} = \left\{ x^{*b}_{1}, x^{*b}_{2}, x^{*b}_{3}, x^{*b}_{i}, \dots, x^{*b}_{n} \right\} \\
    \vdots \\
    \mathbf{x}^{*B} = \left\{ x^{*B}_{1}, x^{*B}_{2}, x^{*B}_{3}, x^{*B}_{i}, \dots, x^{*B}_{n} \right\}
  \end{bmatrix}, \\
  b
  =
  \left\{
    1, 2, 3, \dots, B
  \right\}, \\
  i
  =
  \left\{
    1, 2, 3, \dots, n
  \right\}  
\end{equation}\]</span></p>
<p>The function <code><a href="../../reference/nb.html">nb()</a></code> from the <code>jeksterslabRboot</code> package can be used to generate <code>B</code> nonparametric bootstrap samples. The argument <code>data</code> takes in a vector, matrix, or data frame. <code>data</code> is the empirical distribution <span class="math inline">\(\hat{F}\)</span>. In the example below, we use <code>x</code>, which is the sample data above, as the argument <code>data</code>. The argument <code>B</code> takes an integer. <code>B</code> is the number of bootstrap samples <code>B =</code> 1000 in our case. Optional arguments include <code>par</code> which is a logical argument to enable the use of multiple cores and <code>ncores</code> which is the number of cores to use. The <code><a href="../../reference/nb.html">nb()</a></code> function returns a <code>list</code> of length <code>B</code> bootstrap samples. <span class="math inline">\(x^{*}\)</span> is saved as <code>x_star</code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">x_star</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/nb.html">nb</a></span>(
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">x</span>,
  <span class="kw">B</span> <span class="kw">=</span> <span class="no">B</span>
)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">x_star</span>, <span class="kw">list.len</span> <span class="kw">=</span> <span class="fl">6</span>)
<span class="co">#&gt; List of 1000</span>
<span class="co">#&gt;  $ : num [1:1000] 128.4 119.5 115.2 75.8 116.4 ...</span>
<span class="co">#&gt;  $ : num [1:1000] 110.9 94.6 113.5 98.4 78 ...</span>
<span class="co">#&gt;  $ : num [1:1000] 121.7 81.9 89.1 90.8 82.2 ...</span>
<span class="co">#&gt;  $ : num [1:1000] 96.7 55.1 102.4 89.1 104.1 ...</span>
<span class="co">#&gt;  $ : num [1:1000] 110 84.5 84.2 105.6 88.8 ...</span>
<span class="co">#&gt;  $ : num [1:1000] 92.5 83.3 95.9 100.7 96.1 ...</span>
<span class="co">#&gt;   [list output truncated]</span></pre></body></html></div>
</div>
<div id="bootstrap-sampling-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#bootstrap-sampling-distribution" class="anchor"></a>Bootstrap Sampling Distribution</h3>
<p>The parameter is estimated for each of the <span class="math inline">\(B\)</span> bootstrap samples. For example, if we are interested in making inferences about the mean, we calculate the sample statistic (<span class="math inline">\(\mathrm{s}\)</span>), that is, the sample mean, for each element of <span class="math inline">\(\mathbf{x}^{*}\)</span>. The <span class="math inline">\(B\)</span> estimated parameters form the bootstrap sampling distribution <span class="math inline">\(\boldsymbol{\hat{\theta}^{*}}\)</span>.</p>
<p><span class="math display">\[\begin{equation}
  \boldsymbol{\hat{\theta}^{*}}
  =
  \begin{bmatrix}
    \hat{\theta}^{*} \left( 1 \right) = \mathrm{s} \left( \mathbf{x}^{*1} \right) \\
    \hat{\theta}^{*} \left( 2 \right) = \mathrm{s} \left( \mathbf{x}^{*2} \right) \\
    \hat{\theta}^{*} \left( 3 \right) = \mathrm{s} \left( \mathbf{x}^{*3} \right) \\
    \hat{\theta}^{*} \left( b \right) = \mathrm{s} \left( \mathbf{x}^{*b} \right) \\
    \vdots \\
    \hat{\theta}^{*} \left( B \right) = \mathrm{s} \left( \mathbf{x}^{*B} \right)
  \end{bmatrix}, \\
  b
  =
  \left\{
    1, 2, 3, \dots, B
  \right\}
\end{equation}\]</span></p>
<p><code>sapply</code> is a useful tool in <code>R</code> to apply a function to each element of a list. In our case, we apply the function <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> to each element of the list <code>x_star</code>. <code>sapply</code> simplifies the output when possible. In our case, <code>sapply</code> returns a vector, <code>thetahat_star</code>. The <code>*apply</code> functions as well as their parallel counterparts (e.g., <code>parSapply</code>) can be used to simplify repetitive tasks.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">thetahat_star</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(
  <span class="kw">X</span> <span class="kw">=</span> <span class="no">x_star</span>,
  <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">mean</span>
)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">thetahat_star</span>)
<span class="co">#&gt;  num [1:1000] 100.5 99.5 99.4 99.8 100 ...</span></pre></body></html></div>
<p><img src="notes_intro_nb_files/figure-html/unnamed-chunk-11-1.png" width="700"><img src="notes_intro_nb_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
</div>
<div id="estimated-bootstrap-standard-error" class="section level3">
<h3 class="hasAnchor">
<a href="#estimated-bootstrap-standard-error" class="anchor"></a>Estimated Bootstrap Standard Error</h3>
<p>The estimated bootstrap standard error is given by</p>
<p><span class="math display">\[\begin{equation}
  \widehat{\mathrm{se}}_{\mathrm{B}}
  \left(
    \hat{\theta}
  \right)
  =
  \sqrt{
    \frac{1}{B - 1}
    \sum_{b = 1}^{B}
    \left[
      \hat{\theta}^{*} \left( b \right)
      -
      \hat{\theta}^{*} \left( \cdot \right)
    \right]^2
  }
  =
  0.4879561
\end{equation}\]</span></p>
<p>where</p>
<p><span class="math display">\[\begin{equation}
  \hat{\theta}^{*}
  \left(
    \cdot
  \right)
  =
  \frac{1}{B}
  \sum_{b = 1}^{B}
  \hat{\theta}^{*} \left( b \right) 
  =
  99.5814296
  .
\end{equation}\]</span></p>
<p>Note that <span class="math inline">\(\widehat{\mathrm{se}}_{\mathrm{B}} \left( \hat{\theta} \right)\)</span> is the standard deviation of <span class="math inline">\(\boldsymbol{\hat{\theta}^{*}}\)</span> and <span class="math inline">\(\hat{\theta}^{*} \left( \cdot \right)\)</span> is the mean of <span class="math inline">\(\boldsymbol{\hat{\theta}^{*}}\)</span> .</p>
<table class="table">
<caption>Nonparametric Bootstrapping Results</caption>
<colgroup>
<col width="7%">
<col width="14%">
<col width="72%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
<th align="left">Notation</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>B</code></td>
<td align="left">Number of bootstrap samples.</td>
<td align="left"><span class="math inline">\(B\)</span></td>
<td align="right">1000.0000000</td>
</tr>
<tr class="even">
<td align="left"><code>mean_thetahat_star</code></td>
<td align="left">Mean of <span class="math inline">\(B\)</span> sample means.</td>
<td align="left"><span class="math inline">\(\hat{\theta}^{*} \left( \cdot \right) = \frac{1}{B} \sum_{b = 1}^{B} \hat{\theta}^{*} \left( b \right)\)</span></td>
<td align="right">99.5814296</td>
</tr>
<tr class="odd">
<td align="left"><code>var_thetahat_star</code></td>
<td align="left">Variance of <span class="math inline">\(B\)</span> sample means.</td>
<td align="left"><span class="math inline">\(\widehat{\mathrm{Var}}_{\mathrm{B}} \left( \hat{\theta} \right) = \frac{1}{B - 1} \sum_{b = 1}^{B} \left[ \hat{\theta}^{*} \left( b \right) - \hat{\theta}^{*} \left( \cdot \right) \right]^2\)</span></td>
<td align="right">0.2381012</td>
</tr>
<tr class="even">
<td align="left"><code>sd_thetahat_star</code></td>
<td align="left">Standard deviation of <span class="math inline">\(B\)</span> sample means.</td>
<td align="left"><span class="math inline">\(\widehat{\mathrm{se}}_{\mathrm{B}} \left( \hat{\theta} \right) = \sqrt{ \frac{1}{B - 1} \sum_{b = 1}^{B} \left[ \hat{\theta}^{*} \left( b \right) - \hat{\theta}^{*} \left( \cdot \right) \right]^2 }\)</span></td>
<td align="right">0.4879561</td>
</tr>
</tbody>
</table>
</div>
<div id="confidence-intervals" class="section level3">
<h3 class="hasAnchor">
<a href="#confidence-intervals" class="anchor"></a>Confidence Intervals</h3>
<p>Confidence intervals can be constructed around <span class="math inline">\(\hat{\theta}\)</span> . The functions <code><a href="../../reference/pc.html">pc()</a></code>, <code><a href="../../reference/bc.html">bc()</a></code>, and <code><a href="../../reference/bca.html">bca()</a></code> from the <code>jeksterslabRboot</code> package can be used to construct confidence intervals using the default alphas of 0.001, 0.01, and 0.05. Wald confidence intervals (<code><a href="../../reference/wald.html">wald()</a></code>) are added for comparison. The confidence intervals can also be evaluated. Since we know the population parameter theta <span class="math inline">\(\left(\theta = \mu = 100 \right)\)</span>, we can check if our confidence intervals contain the population parameter.</p>
<p>See documentation for <code><a href="../../reference/wald.html">wald()</a></code>, <code><a href="../../reference/pc.html">pc()</a></code>, <code><a href="../../reference/bc.html">bc()</a></code>, and <code><a href="../../reference/bca.html">bca()</a></code> from the <code>jeksterslabRboot</code> package on how confidence intervals are constructed.</p>
<p>See documentation for <code><a href="../../reference/zero_hit.html">zero_hit()</a></code>, <code><a href="../../reference/theta_hit.html">theta_hit()</a></code>, <code><a href="../../reference/len.html">len()</a></code>, and <code><a href="../../reference/shape.html">shape()</a></code> from the <code>jeksterslabRboot</code> package on how confidence intervals are evaluated.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">wald_out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/wald.html">wald</a></span>(
  <span class="kw">thetahat</span> <span class="kw">=</span> <span class="no">thetahat</span>,
  <span class="kw">sehat_thetahat</span> <span class="kw">=</span> <span class="no">sehat_thetahat</span>,
  <span class="kw">eval</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">theta</span> <span class="kw">=</span> <span class="no">theta</span>
)
<span class="no">wald_out_t</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/wald.html">wald</a></span>(
  <span class="kw">thetahat</span> <span class="kw">=</span> <span class="no">thetahat</span>,
  <span class="kw">sehat_thetahat</span> <span class="kw">=</span> <span class="no">sehat_thetahat</span>,
  <span class="kw">distribution</span> <span class="kw">=</span> <span class="st">"t"</span>,
  <span class="kw">df</span> <span class="kw">=</span> <span class="no">df</span>,
  <span class="kw">eval</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">theta</span> <span class="kw">=</span> <span class="no">theta</span>
)
<span class="no">pc_out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/pc.html">pc</a></span>(
  <span class="kw">thetahat_star</span> <span class="kw">=</span> <span class="no">thetahat_star</span>,
  <span class="kw">thetahat</span> <span class="kw">=</span> <span class="no">thetahat</span>,
  <span class="kw">wald</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">eval</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">theta</span> <span class="kw">=</span> <span class="no">theta</span>
)
<span class="no">bc_out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/bc.html">bc</a></span>(
  <span class="kw">thetahat_star</span> <span class="kw">=</span> <span class="no">thetahat_star</span>,
  <span class="kw">thetahat</span> <span class="kw">=</span> <span class="no">thetahat</span>,
  <span class="kw">wald</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">eval</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">theta</span> <span class="kw">=</span> <span class="no">theta</span>
)
<span class="no">bca_out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../../reference/bca.html">bca</a></span>(
  <span class="kw">thetahat_star</span> <span class="kw">=</span> <span class="no">thetahat_star</span>,
  <span class="kw">thetahat</span> <span class="kw">=</span> <span class="no">thetahat</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">x</span>,
  <span class="kw">fitFUN</span> <span class="kw">=</span> <span class="no">mean</span>,
  <span class="kw">wald</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">eval</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">theta</span> <span class="kw">=</span> <span class="no">theta</span>
)</pre></body></html></div>
<table class="table">
<caption>Confidence Intervals</caption>
<colgroup>
<col width="2%">
<col width="4%">
<col width="1%">
<col width="4%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="6%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="5%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">statistic</th>
<th align="right">p</th>
<th align="right">se</th>
<th align="right">ci_0.05</th>
<th align="right">ci_0.5</th>
<th align="right">ci_2.5</th>
<th align="right">ci_97.5</th>
<th align="right">ci_99.5</th>
<th align="right">ci_99.95</th>
<th align="right">zero_hit_0.001</th>
<th align="right">zero_hit_0.01</th>
<th align="right">zero_hit_0.05</th>
<th align="right">theta_hit_0.001</th>
<th align="right">theta_hit_0.01</th>
<th align="right">theta_hit_0.05</th>
<th align="right">length_0.001</th>
<th align="right">length_0.01</th>
<th align="right">length_0.05</th>
<th align="right">shape_0.001</th>
<th align="right">shape_0.01</th>
<th align="right">shape_0.05</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">wald</td>
<td align="right">209.4737</td>
<td align="right">0</td>
<td align="right">0.4755376</td>
<td align="right">98.04786</td>
<td align="right">98.38773</td>
<td align="right">98.68060</td>
<td align="right">100.5447</td>
<td align="right">100.8375</td>
<td align="right">101.1774</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3.129538</td>
<td align="right">2.449807</td>
<td align="right">1.864073</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">wald_t</td>
<td align="right">209.4737</td>
<td align="right">0</td>
<td align="right">0.4755376</td>
<td align="right">98.04322</td>
<td align="right">98.38539</td>
<td align="right">98.67947</td>
<td align="right">100.5458</td>
<td align="right">100.8399</td>
<td align="right">101.1820</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3.138826</td>
<td align="right">2.454496</td>
<td align="right">1.866334</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="left">pc</td>
<td align="right">204.1426</td>
<td align="right">0</td>
<td align="right">0.4879561</td>
<td align="right">98.06326</td>
<td align="right">98.21239</td>
<td align="right">98.63318</td>
<td align="right">100.4538</td>
<td align="right">100.8186</td>
<td align="right">101.0342</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2.970926</td>
<td align="right">2.606214</td>
<td align="right">1.820627</td>
<td align="right">0.9175043</td>
<td align="right">0.8612579</td>
<td align="right">0.8588161</td>
</tr>
<tr class="even">
<td align="left">bc</td>
<td align="right">204.1426</td>
<td align="right">0</td>
<td align="right">0.4879561</td>
<td align="right">98.06337</td>
<td align="right">98.28194</td>
<td align="right">98.68233</td>
<td align="right">100.5633</td>
<td align="right">100.8607</td>
<td align="right">101.0384</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2.974997</td>
<td align="right">2.578771</td>
<td align="right">1.880929</td>
<td align="right">0.9202657</td>
<td align="right">0.9379197</td>
<td align="right">1.0218532</td>
</tr>
<tr class="odd">
<td align="left">bca</td>
<td align="right">204.1426</td>
<td align="right">0</td>
<td align="right">0.4879561</td>
<td align="right">98.06337</td>
<td align="right">98.28193</td>
<td align="right">98.68232</td>
<td align="right">100.5632</td>
<td align="right">100.8607</td>
<td align="right">101.0384</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2.974991</td>
<td align="right">2.578771</td>
<td align="right">1.880891</td>
<td align="right">0.9202613</td>
<td align="right">0.9379057</td>
<td align="right">1.0217909</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="notes" class="section level2">
<h2 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h2>
<p>The estimated bootstrap standard error is similar to results from the closed form solution. The estimated bootstrap confidence intervals are also close to the Wald confidence intervals. While a closed form solution for the standard error is available in this simple example, bootstrap standard errors and confidence intervals can be used in situations when standard errors are not easy to calculate.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li>Efron, B., &amp; Tibshirani, R. J. (1993). <em>An introduction to the bootstrap</em>. New York, N.Y: Chapman &amp; Hall.</li>
<li><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">Wikipedia: Bootstrapping (statistics)</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ivan Jacob Agaloos Pesigan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
