% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wald.R
\name{wald}
\alias{wald}
\title{Confidence Interval - Wald}
\usage{
wald(
  thetahat,
  se_thetahat,
  theta_null = 0,
  alpha = c(0.001, 0.01, 0.05),
  distribution = "z",
  df,
  eval = FALSE,
  theta = 0
)
}
\arguments{
\item{thetahat}{Numeric.
Parameter estimate
(\eqn{\hat{\theta}}).}

\item{se_thetahat}{Numeric.
Standard error of \code{thetahat}
(\eqn{\mathrm{se} \left( \hat{\theta} \right)}).}

\item{theta_null}{Numeric.
Hypothesized value of \code{theta}
(\eqn{\theta_{0}}).
Set to zero by default.}

\item{alpha}{Numeric vector.
Alpha level.
By default,
\code{alpha} is set to conventional
alpha levels
\code{alpha = c(0.001, 0.01, 0.05)}.}

\item{distribution}{Character string.
\code{distribution = "z"} for the standard normal distribution.
\code{distribution = "t"} for the t distribution.}

\item{df}{Numeric.
Degrees of freedom (df) if \code{distribution = "t"}.
Ignored if \code{distribution = "z"}.}

\item{eval}{Logical.
Evaluate confidence intervals using
\code{\link[=zero_hit]{zero_hit()}},
\code{\link[=theta_hit]{theta_hit()}},
\code{\link[=len]{len()}},
and
\code{\link[=shape]{shape()}}.}

\item{theta}{Numeric.
Population parameter
(\eqn{\theta}).}
}
\value{
Returns a vector with the following elements:
\describe{
\item{statistic}{Square root of Wald test statistic.}
\item{p}{p-value.}
\item{se}{Standard error of thetahat (\eqn{\mathrm{se} \left( \hat{\theta} \right)}).}
\item{ci_}{Estimated confidence limits corresponding to alpha.}
}
If \code{eval = TRUE},
also returns
\describe{
\item{zero_hit_}{Logical. Tests if confidence interval contains zero.}
\item{theta_hit_}{Logical. Tests if confidence interval contains theta.}
\item{length_}{Length of confidence interval.}
\item{shape_}{Shape of confidence interval.}
}
}
\description{
Calculates symmetric Wald confidence intervals.
}
\details{
As the sample size approaches infinity (\eqn{n \to \infty}),
the distribution of \eqn{\hat{\theta}}
approaches the normal distribution
with mean equal to \eqn{\theta}
and variance equal to \eqn{\mathrm{Var} \left( \hat{\theta} \right)}
\deqn{
    \hat{\theta}
    \mathrel{\dot\sim}
    \mathcal{N}
    \left(
      \theta,
      \mathrm{Var}
      \left(
        \hat{\theta}
      \right)
    \right) .
  }
As such,
\eqn{
    \hat{\theta}
  }
can be expressed in terms of
\eqn{z}-scores
from a standard normal distribution
\deqn{
    \frac{
      \hat{\theta} - \theta
    }
    {
      \mathrm{se}
      \left(
        \hat{\theta}
      \right)
    }
    \mathrel{\dot\sim}
    \mathcal{N}
    \left(
      0,
      1
    \right)
  }
where
\eqn{
    \mathrm{se}
      \left(
        \hat{\theta}
      \right)
    =
    \sqrt{
      \mathrm{Var}
      \left(
        \hat{\theta}
      \right)
    }
  }.

To form a confidence interval around \eqn{\hat{\theta}},
the \eqn{z}-score associated with a particular
alpha level
can be plugged-in the equation below.
\deqn{
    \hat{\theta}
    \pm
    z_{\frac{\alpha}{2}}
    \times
    \mathrm{se}
      \left(
        \hat{\theta}
      \right)
  }

Note that this is valid only when \eqn{n \to \infty}.
In finite samples,
this is only an approximation.
Gosset derived a better approximation
in the context of \eqn{\hat{\theta} = \bar{x}}
\deqn{
    \frac{
      \hat{\theta} - \theta
    }
    {
      \mathrm{se}
      \left(
        \hat{\theta}
      \right)
    }
    \mathrel{\dot\sim}
    t \left( \nu \right)
  }
where \eqn{\nu} is the degrees of freedom
\eqn{n - 1}.
As such,
the symmetric Wald confidence interval is given by
\deqn{
    \hat{\theta}
    \pm
    t_{\frac{\alpha}{2}}
    \times
    \mathrm{se}
      \left(
        \hat{\theta}
      \right)
  }
from a \eqn{t} distribution with degrees of freedom \eqn{\nu = n - 1}.
Note that in large sample sizes,
\eqn{t} converges to \eqn{z}.
}
\examples{
#############################################################
# Generate sample data from a normal distribution
# with mu = 0 and sigma^2 = 1.
#############################################################
set.seed(42)
n <- 10000
x <- rnorm(n = n)

#############################################################
# Estimate the population mean mu using the sample mean xbar.
#############################################################
# Parameter estimate xbar
thetahat <- mean(x)
thetahat
# Closed form solution for the standard error of the mean
se_thetahat <- sd(x) / sqrt(n)
se_thetahat

#############################################################
# Generate Wald confidence intervals
# for alpha = c(0.001, 0.01, 0.05).
#############################################################
wald(
  thetahat = thetahat,
  se_thetahat = se_thetahat
)
}
\references{
\href{https://en.wikipedia.org/wiki/Confidence_interval}{Wikipedia: Confidence interval}
}
\author{
Ivan Jacob Agaloos Pesigan
}
\concept{Wald confidence interval functions}
\keyword{Wald}
\keyword{confidence}
\keyword{interval,}
\keyword{test}
